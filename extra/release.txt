bundle exec unicorn_rails -c /home/deployer/apps/hg_ehr_product/config/unicorn_preproduction.rb -D -E preproduction
1.City State Dropdown Search at User ,Organisation and Facility level 
Points : 1.Country Seed File  bundle exec rake db:dump:country_seed
         2.bundle exec rake update_country_id:facility RAILS_ENV=development       
         3.bundle exec rake update_country_id:user RAILS_ENV=development
         4.bundle exec rake update_country_id:organisation RAILS_ENV=development
         5.If all Successfully done then we can run country_seed with Delete_all uncomment for removing multiple entries

2.Added Diagnsis and Procedure search for freeform template in Ophthalmology
3.Added Diagnsis and investigation for freeform template in Ortho

RAKE : bundle exec rake update_diagnosis_field:opdrecord RAILS_ENV=development

1.

ophthal_investigations_list
radiology_investigations_list
laboratory_investigations_list



Release 14-08-2018
A.Testing on Local for Userlevel for City State Search  
1.

B.Testing on Local for Freeform template Diagnosis and Procedure and Investigation
  Ortho 
1.See Old Data for Procedure and Diagnosis and Investigation and See all the record 
2.See the Diagnosis and Old Data logic
3.See Updated new data for Edit and New Case 
4.See Updated data and old data on IPD Side like diagnosis comments and Procedure comments and Radiology comments and Old comments  
5.Print of Freeform template 
6.Email Print for Freeform template 
7.OPD Patient Report 
8.OPD Patient Excel Sheet 
for Ortho free_procedure : free_procedure 
      diagnosis:       diagnosis_comments 
      plan : remain in the record and laboratorycomments and radiologycomments      


   Ophthamology
1.See Old Data for Procedure and Diagnosis and Investigation and See all the record 
2.See the Diagnosis and Old Data logic
3.See Updated new data for Edit and New Case 
4.See Updated data and old data on IPD Side like diagnosis comments and Procedure comments and Radiology comments and Old comments  
5.Print of Freeform template 
6.Email Print for Freeform template    
7.OPD Patient Report
8.OPD Patient Excel Sheet 
for Ophthalmology free_procedure : free_procedure 
      diagnosis:       diagnosis_comments 
      plan : remain in the record and laboratorycomments and radiologycomments      




Ortho         : 309989009     orthopedics
Ophthalmology : 309988001     ophthalmology








Query : 
OpdRecord.where(templatetype:"freeform").count                            26
OpdRecord.where(templatetype:"freeform",specalityid: "309988001").count   5
OpdRecord.where(templatetype:"freeform",specalityid: "309989009").count   21
OpdRecord.where(templatetype:"freeform",specalityid: "309989009", diagnosis:nil).count 19
OpdRecord.where(templatetype:"freeform",specalityid: "309989009",:diagnosiscomments.nin:["",nil])





1.Refraction Tab for Eye Template  Revamp with bootstrap 
2.



Eyetemplate Url :  Date : 10 Aug 
New :
http://192.168.0.119:3000/opd_records/ophthalmology_notes/new?appointmentid=5b70f0f32c1b5069a8001d87&patientid=5b70f0f32c1b5069a8001d7d&templatetype=eye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a

Edit : 

rails s --binding=0.0.0.0

Patient Summary:
http://localhost:3000/patient_summary/5b63fd6757554f0acd44924a?appointment_id=5b6457fe57554f0a87bcea13&active_tab=my_queue&active_user=58b6d2605e751b4f33110aa6&doctors_list=in&current_date=2018-08-03&url=/outpatients/appointment_management&mode=tabview&token=06daed5ead713c074c40ccad6ee80044&facility_id=58b6b4626c55d3b8a5400a22

Params :
{"appointment_id":"5b6d5e7c2c1b50050cf95833", "active_tab":"all", "active_user":"58b6d2605e751b4f33110aa6", "doctors_list":"in", "current_date":"2018-08-10", "url":"/outpatients/appointment_management", "_":"1533894826473", "patient_id":"5b6d5e7c2c1b50050cf95829"}


http://localhost:3000/opd_records/ophthalmology_notes/5b6d66582c1b50050cf95955/edit?appointmentid=5b6d5e7c2c1b50050cf95833&mode=tabview&opdrecordid=5b6d66582c1b50050cf95955&patientid=5b6d5e7c2c1b50050cf95829&templatetype=eye&token=feff99ae0ffc4e51f5a56e8e806465a9



View Opd Summary :
  /opd_records/view_opd_summary?
 {"appointmentid":"5b6d5e7c2c1b50050cf95833", "opdrecordid":"5b6d66582c1b50050cf95955", "patientid":"5b6d5e7c2c1b50050cf95829", "specality":"309988001", "templatetype":"eye"}






Changes :
app/views/opd_records/ophthalmology_notes/opd_partials/_opd_summary_form_actions.html.erb


1.What we want to achieve with this? 
2.PP Testing 
3.Link Reading 
4.



Task:
A.What are the things We are going to fix 
  1.Top header for tablet view
  2.




Ophthal Department :
1.Eye  : History , Refraction , Examination , Invesitgation ,Diagnosis ,Advice 
2.Opto : Hisory ,  Refraction 
3.Lens : History , Refraction , Examination , Invesitgation ,Diagnosis ,Advice 
4.PMT  : Refraction ,Examination , Diagnosis , Advice 
5.Post Op : Refraction , Examination , Invesitgation ,Diagnosis ,Advice 
6.Quick Eye : History , Refraction , Examination , Invesitgation ,Diagnosis ,Advice
7.Paidiatrics : History , Refraction , Examination , Invesitgation ,Diagnosis ,Advice
8.Orthoptics : History , Refraction , Examination , Invesitgation ,Diagnosis ,Advice
9.Express :   Clinical Assessment , Advice
10.Trauma :   History , Refraction , Examination , Invesitgation ,Diagnosis ,Advice 
11.Freeform : History , Exmainaion , Investigation , Diagnosis , Advice 
12.Blank Form 

Ortho Department :


Examination :




RAPD IN PUPIL









Move Hack : NiitAayog







1.https://www.youtube.com/watch?v=u06fwZPS2k0



http://192.168.0.119:3000/opd_records/ophthalmology_notes/new?appointmentid=5b70f0f32c1b5069a8001d87&patientid=5b70f0f32c1b5069a8001d7d&templatetype=eye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a


http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b7ceb2d2c1b500d968bedc9&patientid=5b7ceb2c2c1b500d968bedbf&templatetype=eye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=f2d16c568e6c00d769a6e66b2ba38c7e

http://192.168.1.16:3000/opd_records/ophthalmology_notes/new?appointmentid=5b7ceb2d2c1b500d968bedc9&patientid=5b7ceb2c2c1b500d968bedbf&templatetype=eye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=f2d16c568e6c00d769a6e66b2ba38c7e




Code :
218OPH12108



Reception :  ort_hosp_reca ort_hosp_reca
Doctor : ort_hosp_doc
Owner  :  ort_hosp_owner
Counseller : ort_hosp_cona 


modified:   app/controllers/opd_records_controller.rb
  modified:   app/views/common_procedures/_get_procedure_details.html.erb
  modified:   app/views/opd_records/_opd_history.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/_eyeobjective1.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/_opd_summary_tab.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/_opd_template_header.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_l_eye_optometrist_examination.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_opd_summary_form.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_opd_summary_form_actions.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_opd_template_form_tabview1.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_plan_tab_medication1.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_r_eye_optometrist_examination.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_regiontemplate_assessment_tab_diagnosis1.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_soap_assessment_tab_ophthalinvestigations.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_advice.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_contactlensprescriptions.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_diagnosis.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_examination.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_glassesprescriptions.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_history.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_laboratoryinvestigations.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_medication.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_ophthalinvestigations.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_procedure.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_radiologyinvestigations.html.erb
  modified:   app/views/templates/common/_opthomology_medications_partial.html.erb
  modified:   app/views/templates/common/_soap_assessment_tab_laboratory_table_list.html.erb
  modified:   app/views/templates/common/_useractionbuttons.html.erb

Untracked files:
  (use "git add <file>..." to include in what will be committed)

  app/views/opd_records/ophthalmology_notes/_opd_summary_tab1.html.erb



Eyettemplate testing
modified:   app/controllers/opd_records/ophthalmology_notes_controller.rb
  modified:   app/views/opd_records/_mail_record_form.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/_opd_summary_tab.html.erb
  deleted:    app/views/opd_records/ophthalmology_notes/_opd_summary_tab1.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/_opd_template_header.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/_opd_template_tabview1.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_opd_summary_form_actions.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_opd_template_form_tabview1.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_plan_tab_medication1.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_contactlensprescriptions.html.erb
  modified:   app/views/templates/common/_updateactionbuttons.html.erb


25-08-2018
EyeTemplate Test
1.Histoy Tab old View Working fine 
2.Refraction Tab Working fine
3.Examination Tab Working fine 
4.Investigaition all 3 tab working fine
5.Diagnosis tab working fine 
6.Advice Tab All working fine 


Issues in Eye Template :
1.Examination GONIOSCOPY not closing once open                             : Done
2.Examination all diagram not working                                      : Done
3.Search Diagnosis and search Procedure and Search Medication not working  : Done 
4.Date picker dialgon not coming properly                                  : Done  
5.Save Medication but cutting                                              : Done 
6.Addtional comment View                                                   : Done   
7.Signed button two line                                                   : Done
8.Email View not coming properly                                           : Done                          
9.Remove Print button in  Contact lens prescription                        : Done
10.Summary top padding                                                     : Done 
11.Comments for Dignosis and procedure box freefrom after merge            : 
12.Merge conflict for rails5_cicd                                          : 
13.Old template Header change                                              : Done 



Fixes:
app/views/opd_records/ophthalmology_notes/opd_partials/_opd_summary_form_actions.html.erb


Merged Conflict
both modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_opd_summary_form_actions.html.erb
both modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_plan_tab_procedures.html.erb
both modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_regiontemplate_assessment_tab_diagnosis.html.erb


http://192.168.1.17:3000/opd_records/ophthalmology_notes/new?appointmentid=5b8360342c1b50120d098eca&patientid=5b8360342c1b50120d098ec0&templatetype=eye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=f2d16c568e6c00d769a6e66b2ba38c7e



Rendering opd_records/ophthalmology_notes/js/save_fundus_diagram.js.erb
  Rendered opd_records/ophthalmology_notes/opd_partials/_save_fundus_diagram.html.erb (2.8ms)
  Rendered templates/common/js/_popup_modal_hidden.js.erb (0.4ms)
  Rendered opd_records/ophthalmology_notes/js/save_fundus_diagram.js.erb (6.3ms)



<%= hidden_field_tag "patient_id", @patient.id, {:class : 'form-control patient_id', :id : "opdrecord_patient_id" } %>



5.Rails5 CiCd Merge          today   Done
6.Manu Histroy Merge         today   Done
7.Excel Sheet CSV to Excel sheet     Done                

Merge Conflict Template_ajit and rails5_cicd
1.app/views/opd_records/ophthalmology_notes/opd_partials/_regiontemplate_assessment_tab_diagnosis.html.erb
2.app/views/opd_records/ophthalmology_notes/opd_partials/_plan_tab_procedures.html.erb
3.app/views/opd_records/ophthalmology_notes/opd_partials/_opd_template_form.html.erb
4.app/views/opd_records/ophthalmology_notes/opd_partials/_opd_summary_form_actions.html.erb

Merge Conflict Manu Histroy and Merge test branc
1.app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_history.html.erb
2.app/views/opd_records/ophthalmology_notes/_eyesubjective.html.erb




http://192.168.0.20:3000/opd_records/ophthalmology_notes/new?appointmentid=5b8360342c1b50120d098eca&patientid=5b8360342c1b50120d098ec0&templatetype=eye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=f2d16c568e6c00d769a6e66b2ba38c7e


http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b8360342c1b50120d098eca&patientid=5b8360342c1b50120d098ec0&templatetype=eye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=f2d16c568e6c00d769a6e66b2ba38c7e



<select class="form-control opdrecord_xraysmrictothersinvestigations_tabview tabview tab_select_tag" id="opdrecord_xraysmrictothersinvestigations_tab" style="display: none;">
            <% opdrecord.xraysmrictothers_investigations(@specalityid, 244486005).each do |custom_record| %>
                <option value="<%= custom_record.investigation_id%>" data-has_laterality = "N" data-investigation_type="<%=custom_record.investigation_type %>"  data-investigation_type_id="244486005" data-specialty_id="<%= @specalityid %>" data-investigation-id="<%= custom_record.investigation_id%>"  data-template_id="<%=custom_record.template_id%>"> <%=custom_record.investigation_name %></option>
            <% end %>
          </select>




 <% if params[:action]!= 'custom_new' && params[:action]!= 'custom_edit' %>
  <%= render partial: "templates/common/patientinfo", locals: { patient: @patient } %>  <!-- Render common patient info template from partial -->
 <% end %>

  

http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=eye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  


Eye

http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=eye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Optometrist
http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=optometrist&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Lens 
http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=lens&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

PMT
http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=pmt&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

PostOp
http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=postop&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

QuickEye:
http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=quickeye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  


PediaTricks
http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=paediatrics&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Orthoptics
http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=orthoptics&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Express
http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=express&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Trauma
http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=trauma&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Freeform
http://127.0.0.1:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=freeform&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  


paediatrics
orthoptics
express
trauma
freeform

Manu
1.Prev and Next button   
2.StepperText Center
3.+ and _ icon Center  
4.Some Examination Heading text
5.
6.

Eye

http://192.168.43.73:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=eye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Optometrist
http://192.168.43.73:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=optometrist&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Lens 
http://192.168.43.73:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=lens&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

PMT
http://192.168.43.73:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=pmt&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

PostOp
http://192.168.43.73:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=postop&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

QuickEye:
http://192.168.43.73:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=quickeye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  


PediaTricks
http://192.168.43.73:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=paediatrics&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Orthoptics
http://192.168.43.73:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=orthoptics&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Express
http://192.168.43.73:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=express&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Trauma
http://192.168.43.73:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=trauma&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Freeform
http://192.168.43.73:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=freeform&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  


Healthgraph

Eye

http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=eye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Optometrist
http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=optometrist&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Lens 
http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=lens&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

PMT
http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=pmt&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

PostOp
http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=postop&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

QuickEye:
http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=quickeye&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  


PediaTricks
http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=paediatrics&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Orthoptics
http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=orthoptics&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Express
http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=express&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Trauma
http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=trauma&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  

Freeform
http://192.168.0.120:3000/opd_records/ophthalmology_notes/new?appointmentid=5b860d702c1b50182e7966ba&patientid=5b860d6f2c1b50182e7966b0&templatetype=freeform&mode=tabview&user_name=oph_hosp_docadmin&facility_id=58b6b4626c55d3b8a5400a22&token=2b42552c419e25704c9d989a8fc6937a  


All template Responsive List 
1.Optometrist : 
  a.Refraction Tab fix
2.Lens :
  a.Refraction Whole tab
  b.Examination part Contact lens and Pupil Comments
  c.Exmaination Edit Mode Refraction
3.PMT
  a.Only Testing Once 
4.Post Op
  a.Surgery Resopnsive test  
5.Quick Eye
  a.Examination Changes
6.Paediatrics 
  a.Exmaination Changes
7.Orthoptics 
  a.Whole Examination 
  b.Testing
8.Express 
  a.Advice tab
  b.Diagnosis tab
9.Truma                    
  a.Examination Ocular truma with test 
10.Free form              Done 
  a.Advice tab
  






https://stackoverflow.com/questions/39079598/how-to-remove-summernote-tooltip-v-0-8-2

1.Rails5 Cicd Merge Concflict
app/views/opd_records/ophthalmology_notes/opd_partials/_plan_tab_advice.html.erb      Done 
app/views/opd_records/ophthalmology_notes/opd_partials/_plan_tab_medication.html.erb  Done
app/views/opd_referrals/_add_intra_facility_referral.html.erb  Done
app/views/opd_referrals/_intra_facility_referral.html.erb      Done
app/views/templates/common/_soap_assessment_tab_radiology_table_list.html.erb  Done 
app/views/opd_records/ophthalmology_notes/opd_partials/_opd_template_form.html.erb   Done
app/views/opd_records/_append_laboratory_investigation.html.erb    Done
app/views/opd_records/ophthalmology_notes/js/_eye_opd_record_assessment.js.erb   Done
app/views/opd_records/ophthalmology_notes/opd_partials/_expresssoap_subjectiveassessment_tab_laboratory.html.erb Done


1.Testing for Conflicts Changes                                     Done                            
A.Medication Sets at all level                                      Done                                          
B.Organisation ID at all Opd Record for Template form tab and Web   Done 
C.All Investigation Js codeCheck at Tablet and Web Level            Done   
D.Radiology Laboratory Test and Ophthal Investigation Test Properly Done   
E.Laboratory Set Not Working on Tablet       Done   
F.Radiology Set Alignment isnot there        Need to do  
G.Medication TAB Padding Udana                
H.Steppers Width 
I.Need to Validate All Investigation            Done 


Issue Found :
app/views/opd_records/ophthalmology_notes/opd_partials/_expresssoap_subjectiveassessment_tab_laboratory.html.erb Done  For Laboratory Set Add Resolved


final Pull Request
1.Optometrist template test   Done  need to change file only
2.Optometrist text cutting    Done 
3.radio and lab file removed  Done  
4.Radiology Investigation alignment Web and Tab  : Test done 
5.Load Css Before JS



Links 
1.https://stackoverflow.com/questions/6005827/what-can-i-do-to-decrease-load-times-of-html-pages/6005832#6005832
2.https://stackoverflow.com/questions/9271276/is-the-recommendation-to-include-css-before-javascript-invalid
3.https://stackoverflow.com/questions/46423595/loading-css-before-javascript



A.All template Responsive 
1.Eye       Done    
2.Freeform  Done 
3.Trauma    Done 
4.Express   Done
5.Orthoptics Done    
6.Pediatrics Done 
7.Quick Eye  Done 
8.PostOp     Done 
9.PMT        Done
10.Lens      Done  
11.Optometrist Done


Doubt and Issues :


Done 
1.Pediatrics Kgs and CMS              Done 
2.Pupil Comments                      Done 
3.IRIS Comments in Exmaination Lens  Done
4.Lens Template Refraction tables    Done        
5.Freeform Followup appoitnment mark Done  
6.Dry Refraction Comments     Done           
7.PGP FillButton Refraction   Done  50    
8.Lens Contact lens in Exmaination :     Done 
9.IntraOcular pressure time optometrist Done 50
10.History Fix final Whaterver itis    Done 
11.Pediatrics History check web and Tab   Done 
12.Lens History Padding               Done
13.Some Time AdviceSet Doesn't comes Why? Done 50
14.Orthopatics Examination L side not Working Done 
15.Test for custom procedures       Done 
16.Frequently diangosis issue in all template Web and APP 
17.Express Frequently Diagnosis  
18.Save Advice and Save Medication set Done 50%
19.On Back Buton pressed    50%
20.Medication Padding Common
21.language not support Medication Set New Logic Needs to Check logic
22.Finall Recheck all change with old list                    
23.Email DropList common

Sikshak


1.app/controllers/api/v1/appointments_controller.rb          Done 
2.app/views/opd_records/_append_custom_radiology_investigation.html.erb  Done 
3.app/views/opd_records/_append_laboratory_investigation.html.erb        Done 
4.app/views/opd_records/_append_radiology_investigation.html.erb         Done 
5.app/views/opd_records/_patient_general_history.html.erb           
6.app/views/opd_records/ophthalmology_notes/_eyesubjective.html.erb      Done 
7.app/views/opd_records/ophthalmology_notes/js/_express_opd_record_subjective.js.erb      UT
8.app/views/opd_records/ophthalmology_notes/js/_eye_opd_record_assessment.js.erb          UT
9.app/views/opd_records/ophthalmology_notes/opd_partials/_expresssoap_subjectiveassessment_tab_laboratory.html.erb  UT
10.app/views/opd_records/ophthalmology_notes/opd_partials/_opd_template_form.html.erb  UT
11.app/views/opd_records/ophthalmology_notes/opd_partials/_plan_tab_advice.html.erb    UT
12.app/views/opd_records/ophthalmology_notes/opd_partials/_plan_tab_medication.html.erb  UT
13.app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_history.html.erb  Done
14.app/views/opd_referrals/_add_intra_facility_referral.html.erb    UT
15.app/views/opd_referrals/_intra_facility_referral.html.erb        UT
16.app/views/patients/form/_history.html.erb                        Done   
17.app/views/templates/common/_soap_assessment_tab_radiology_table_list.html.erb UT
18.app/views/templates/shared/_medication_set_dropdown.html.erb  Done 


Freeform Ortho Url 
http://192.168.43.73:3000/opd_records/orthopedics_notes/new?appointmentid=5b9720a12c1b502e72e063fe&patientid=5b9720a02c1b502e72e063f6&templatetype=freeform&mode=tabview&user_name=ort_hosp_docadmin&facility_id=58b6b46c6c55d3b8a5400a24&token=ac5f420a11ad531f08b2117ad06701c2

http://localhost:3000/opd_records/orthopedics_notes/new?appointmentid=5b95ca292c1b5016234a1871&patientid=5b95ca282c1b5016234a1869&templatetype=freeform

http://localhost:3000/opd_records/orthopedics_notes/new?appointmentid=5b9720a12c1b502e72e063fe&patientid=5b9720a02c1b502e72e063f6&templatetype=freeform

Issue :
1.Template List
2.JS Before CSS
3.Next and Prev Step 
4.Huzi Changes in template 
5.Token Check


Final Testing On New Template 
1.after languagr change Medication in Lens print icon 50 
3.Email Drop Down                      Done 
2.Prev and Next and Step test          Done   
4.PostOp Surgery Dates                 Done   
5.Lens Refraction Tab in table in old tablet  
6.Language Text Cutting in Old tablet  Done  
7.history Systemic comment old tablet  Done 
8.Express Clinical Details Done  




https://stackoverflow.com/questions/7422427/android-webview-slow


opd_records/ophthalmology_notes/post_op_record.html.erb
Research on Fast Webview 


Ortho Freeform Template Planning
1.Radiology Investigation Tab : 
2.Laboratory Investigation Tab :  4 hours 
3.Diagnosis Tab : 6 Hours
4.Medication Tab 4 hours 
5.Referral Facility : 2 hours 
6.Advice : 1 Hours 
7.Testing Template full        : 3 hours 
8.And Small API Related Changes : 3 hours
9.Summary View For Ortho Template : 3 Hours 



1.Ontime 
2.Code Date
3.Documentation 
4.Respect Other time 

Ortho Template :
1.Custom Diagnosis Testing anyhow 
2.Add Medication 
3.




Commit ortho 

modified:   app/views/opd_records/opd_summery_mob.html.erb
modified:   app/views/opd_records/ophthalmology_notes/_opd_summary_tab.html.erb
modified:   app/views/opd_records/ophthalmology_notes/edit.js.erb
modified:   app/views/opd_records/ophthalmology_notes/js/_eye_opd_record_assessment.js.erb
modified:   app/views/opd_records/ophthalmology_notes/new.js.erb
modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_assessment_tab_radiology.html.erb
modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_regiontemplate_assessment_tab_diagnosis.html.erb
modified:   app/views/opd_records/orthopedics_notes/_freeformexaminationplan.html.erb
modified:   app/views/opd_records/orthopedics_notes/_opd_template_header.html.erb
modified:   app/views/opd_records/orthopedics_notes/edit.html.erb
modified:   app/views/opd_records/orthopedics_notes/edit.js.erb
modified:   app/views/opd_records/orthopedics_notes/js/_freeform_save_opdrecord.js.erb
modified:   app/views/opd_records/orthopedics_notes/js/_orthopedics_opd_record_subjective.js.erb
modified:   app/views/opd_records/orthopedics_notes/new.html.erb
modified:   app/views/opd_records/orthopedics_notes/new.js.erb
modified:   app/views/opd_records/orthopedics_notes/opd_partials/_expresssoap_subjectiveassessment_tab_diagnosis.html.erb
modified:   app/views/opd_records/orthopedics_notes/opd_partials/_expresssoap_subjectiveassessment_tab_laboratory.html.erb
modified:   app/views/opd_records/orthopedics_notes/opd_partials/_expresssoap_subjectiveassessment_tab_radiology.html.erb
modified:   app/views/opd_records/orthopedics_notes/opd_partials/_opd_summary_form.html.erb
modified:   app/views/opd_records/orthopedics_notes/opd_partials/_opd_summary_form_actions.html.erb
modified:   app/views/opd_records/orthopedics_notes/opd_partials/_opd_template_form.html.erb
modified:   app/views/opd_records/orthopedics_notes/opd_partials/_opd_template_form_tabview.html.erb
modified:   app/views/opd_records/orthopedics_notes/opd_partials/summary/_opd_summary_form_laboratoryinvestigations.html.erb
modified:   app/views/opd_records/orthopedics_notes/opd_partials/summary/_opd_summary_form_medication.html.erb
modified:   app/views/opd_records/orthopedics_notes/opd_partials/summary/_opd_summary_form_radiologyinvestigations.html.erb
modified:   app/views/templates/common/_expresssoap_plan_tab_advice.html.erb
modified:   app/views/templates/common/_expresssoap_plan_tab_medication.html.erb
modified:   app/views/templates/common/_medications_partial.html.erb




Second 
modified:   app/views/opd_records/_ortho_replace_medication_instruction.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/_opd_summary_tab.html.erb
  modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_plan_tab_advice.html.erb
  modified:   app/views/opd_records/orthopedics_notes/_opd_summary.html.erb
  modified:   app/views/opd_records/orthopedics_notes/_opd_summary_tab.html.erb
  modified:   app/views/opd_records/orthopedics_notes/opd_partials/_opd_summary_form_actions.html.erb
  modified:   app/views/opd_records/orthopedics_notes/opd_partials/summary/_opd_summary_form_laboratoryinvestigations.html.erb
  modified:   app/views/templates/common/_expresssoap_plan_tab_medication.html.erb



Buggy File 
app/views/opd_records/orthopedics_notes/_freeformexaminationplan.html.erb
app/views/opd_records/orthopedics_notes/js/_orthopedics_opd_record_plan.js.erb


Final Conflicts :
app/views/opd_referrals/_intra_facility_referral.html.erb
app/views/opd_records/ophthalmology_notes/opd_partials/_plan_tab_advice.html.erb

Gem Conflicts 
modified:   Gemfile
modified:   Gemfile.lock


Appointment Task 
1.OpdClinicalWorkflow.count
2.Appointment.count
3.AppointmentListView.count


AppointmentListView  
  time type in this model
  1.appointment_start_time
  2.appointment_engaged_time
  3.appointment_end_time

  States:
    current_state, default: "Scheduled"
    Scheduled  Waiting Engaged Completed

  Time Diff 
   @waiting_time
   @@engaged_time

patient_time   

OpdClinicalWorkflow 

Button Clicks to Appointents Controller 
  patient_arrived
  patient_engaged
  patient_completed

Workflow 
5b9b8c482c1b503192f4d0fa
Nonworkflow ID 
5b9b8ccb2c1b503192f4d1be


State Machine Gem Reading 
Transition Create 
WorkflowOpdService 
See the Current Data from Where Its coming 
think How to write that data to the transition Table
 


Tasks:
1.Review Pull Request 
2.State Machine Gem Reading 
3.See the Current Data from Where Its coming 
4.think How to write that data to the transition Table


ReviewPull Request 
1.Patient Mr No On Template Header Or Not 
2.


ophthalmology_notes_controller.rb


Huzis:
models/inpatient/ipd_record.rb





Remember 
clinical-workflow-timeline

Possible states
Scheduled
Engaged
Completed

Appointment flow Change Task 
outpatients/appointment/appointment_details/_appointment_timeline.html.erb 
outpatients/appointment/appointment_details/_appointment_details_section.html.erb


ap OpdClinicalWorkflowStateTransition.last

 @clinical_workflow_present


New Suggestions 
1.


:_id : BSON::ObjectId('5b9dcee22c1b5017b75036c9'),
    :created_at : 2018-09-16 03:32:50 UTC,
 :department_id : "309988001",
         :event : "doctor_to_ophthal_investigation",
          :from : "doctor",
     :namespace : nil,
:opd_clinical_workflow_id : BSON::ObjectId('5b9db4d52c1b5017b75032d4'),
            :to : "ophthal_investigation",
:transition_end : nil,
:transition_start : 2018-09-16 03:32:50 UTC,
    :updated_at : 2018-09-16 03:32:50 UTC,
       :user_id : nil


Non Workflow States
1.not_arrived
2.waiting
3.engaged
4.completed 


Possible Events 
1.not_arrived

all buttons with state transitions        For Clinical Workflow
Initial State :  Scheduled     scheduled           not_arrived
PatientArrived:  scheduled  to Waiting    not_arrived to Waiting     New transistion                                          Transition end 
NA :             waiting to  scheduled    waiting to not_arrived     delete Recent Transistion and delete all states   
Mark Engaged :   waiting to engaged       waiting to engaged         create new state transition with waiting to engaged
undo :           engaged to waiting       engaged to waiting         last state delete and second last state transition end nil       
3Mark Completed : waiting to completed     waiting to completed      create new state 
Reverse Completed : completed to waiting   completed to waiting      last state delete 
2Mark Completed : engaged to completed     engaged to completed      create new state engaged  
Reverse Complete : completed to engaged    completed to engaged      Last state Delete           


Need to write the logic to create new states or updating current states 


Query for transistion state 
ap OpdClinicalWorkflow.find_by(appointment_id:"5b9f0f002c1b500cf25ff780").opd_clinical_workflow_state_transitions.last


Not arrived case no state only update initial state to notarrived in workflow model and delete all the stated by finding all states 

Logic for Migration  
current_state   transition state count  
Scheduled          0 
Waiting            1    Transistion start time = Appointment start time EndTime : current time
Engaged            2    notarrived to waiting: engaged time - start time and waiting to engaged : current - engaged time
Completed          2, 3   When Engaged time exist :3 else 2  



Used Query 
Mr One 
ap OpdClinicalWorkflow.find("5b9f690b2c1b50104b88c525")
ap OpdClinicalWorkflowStateTransition.where(opd_clinical_workflow_id:"5b9f690b2c1b50104b88c525").last
ap OpdClinicalWorkflowStateTransition.where(opd_clinical_workflow_id:"5b9f690b2c1b50104b88c525").count

ap OpdClinicalWorkflow.find("5b9f76992c1b50104b88cb78")
ap OpdClinicalWorkflow.find_by(appointment_id:"5b9f76992c1b50104b88cb76")
ap OpdClinicalWorkflowStateTransition.where(opd_clinical_workflow_id:"5b9f76992c1b50104b88cb78").count

Variable Scope @ and not @ 






# bundle exec rake update_nonworkflow_state:facility RAILS_ENV=development

namespace :update_country_id do
  desc "updating country id in facility"
  task :facility : :environment do
    
    Facility.all.each_with_index do  |facility,index|
      if !facility.clinical_workflow
        puts facility.display_name
        appointments = Appointment.where(facility_id:facility.id)
        puts appointments.count
        appointments.each_with_index do |appointment,id|
          AppointmentListView.
        end
      end
    end
  end
end



ap OpdClinicalWorkflowStateTransition.where(opd_clinical_workflow_id:"5ba0c3412c1b500c2c972847").count









































Old Methods
  def patient_arrived
    if params[:patient_arrived].to_s == "true"
      @appointment.update(current_state: "waiting", arrived_time: Time.current)
      @active_tab = "waiting"
    else
      @token_setting = TokenSetting.find_by(facility_id: @appointment.facility_id)
      remove_assigned_token if @token_setting.try(:token_enabled)

      @appointment.update(current_state: "scheduled", arrived_time: nil, token_number: nil)
      @active_tab = "scheduled"
    end
    respond_to do |format|
      format.js { render 'appointments/state' }
    end
    if params[:patient_arrived].to_s == "true"
      Patients::Summary::TimelineWorker.call({event_name: "OPD_APPOINTMENT", sub_event_name: "ARRIVED", appointment_id: @appointment.id, user_id: current_user.id, user_name: current_user.fullname })
    else
      pst = PatientSummaryTimeline.where(event_name: "OPD APPOINTMENT", query: { _id: @appointment.id.to_s })
      pst1 = pst.where(sub_event_name: "ARRIVED").delete_all
      @appointment_list_view.update(current_state: "Scheduled") #Temp Hack
      pst3 = pst.where(sub_event_name: "EDITED").update_all(links: {appointment: @appointment_list_view.attributes})
      pst4 = pst.where(sub_event_name: "RESCHEDULED").update_all(links: {appointment: @appointment_list_view.attributes})      
    end
  end

  def patient_engaged
    if params[:patient_engaged].to_s == "true"
      @appointment.update(current_state: "engaged", engage_time: Time.current)
      @active_tab = "engaged"
    else
      @appointment.update(current_state: "waiting", engage_time: nil)
      @active_tab = "waiting"
    end
    respond_to do |format|
      format.js { render 'appointments/state' }
    end
    pst = PatientSummaryTimeline.where(event_name: "OPD APPOINTMENT", sub_event_name: "ENGAGED", query: { _id: @appointment.id.to_s })
    if params[:patient_engaged].to_s == "true"
      Patients::Summary::TimelineWorker.call({event_name: "OPD_APPOINTMENT", sub_event_name: "ENGAGED", appointment_id: @appointment.id, user_id: current_user.id, user_name: current_user.fullname })
    else
      pst.delete_all if pst.count > 0
    end
  end

  def patient_completed
    if params[:patient_completed].to_s == "true"
      @appointment.update(current_state: "seen", end_time: Time.current, seen_time: Time.current)
      @active_tab = "completed"
      SmsJob.perform_later("visit_sms",@appointment.id.to_s,@appointment.class.to_s)
    else
      @appointment.update(current_state: "engaged", end_time: nil, seen_time: nil)
      @active_tab = "engaged"
      SmsJob.perform_later("cancel_sms",@appointment.id.to_s,@appointment.class.to_s)
      if @appointment.engage_time.present?
        @appointment.update(current_state: "engaged", end_time: nil, seen_time: nil)
        @active_tab = "engaged"
      else
        @appointment.update(current_state: "waiting", end_time: nil, seen_time: nil)
        @active_tab = "waiting"
      end
    end
    respond_to do |format|
      format.js { render 'appointments/state' }
    end
    pst = PatientSummaryTimeline.where(event_name: "OPD APPOINTMENT", sub_event_name: "COMPLETED", query: { _id: @appointment.id.to_s })
    if params[:patient_completed].to_s == "true"
      Patients::Summary::TimelineWorker.call({event_name: "OPD_APPOINTMENT", sub_event_name: "COMPLETED", appointment_id: @appointment.id, user_id: current_user.id, user_name: current_user.fullname })
    else
      pst.delete_all if pst.count > 0
    end
  end

<% unless @appointment_list_view.current_state == "Scheduled" %>
    <div class="row no_margin no_padding clinical-workflow-timeline" style="margin: 0 auto;">
      <div class="col-xs-12 text-center" style="line-height: 2;">
        <% if @appointment_list_view.current_state != "Scheduled" %>
          <label style="font-size:12px;border-radius: 12px;" class="label label-danger">Arrived</label>
          <i class="fa fa-long-arrow-right fa-xs"></i>
          <label style="font-size:12px;border-radius: 12px;" class="label label-warning" title="<%= @waiting_time %>">Waiting</label>
        <% end %>
        <% if @appointment_list_view.current_state == "Engaged" || @appointment_list_view.current_state == "Completed" %>
          <% if @appointment_list_view.appointment_engaged_time.present? %>
            <i class="fa fa-long-arrow-right fa-xs"></i>
            <label style="font-size:12px;border-radius: 12px;background: #ff8735;" class="label label-warning" title="<%= @engaged_time %>">Engaged</label>
          <% end %>
        <% end %>
        <% if @appointment_list_view.current_state == "Completed" %>
          <i class="fa fa-long-arrow-right fa-xs"></i>
          <label style="font-size:12px;border-radius: 12px;" class="label label-success">Completed</label>
        <% end %>
      </div>
    </div>
  <% end %>


Reading about eager loading and lazy loading 
Revert Merge Conflict
Diff @ and not@

Tasks:
1.All till now code Review and Optimizations    
2.And Move this code to  OpdClinical Workflow Controller for both web and API Side 
3.See the Effect of these change at other places from Summary and Prescription file  Done 
4.Change API Buttons and Web Urls and Routes  files  
5.ViewSide Change at all place 

On Android Side Change the button action code and urls 






Needs To Change This 
app/views/investigation/investigation_managements/investigation_details/_clinical_workflow_timeline.html.erb
app/views/prescriptions/pharmacy/pharmacy_details/_clinical_workflow_timeline.html.erb
app/views/prescriptions/optical/optical_details/_clinical_workflow_timeline.html.erb
app/views/outpatients/appointment/appointment_details/_appointment_timeline.html.erb


Controller Changes 
app/controllers/outpatients_controller.rb
app/controllers/prescriptions_controller.rb
pp/controllers/api/v1/appointments_controller.rb
app/controllers/investigation/investigation_managements_controller



Testing 
1.Optical Patient 
2.Pharmacy Patient
3.Investigation Details Lab Ophthal Radiology 

Issues :
1.Unable to Add Radiology invesitgation form Patient RHS Done:Huzi
2.Unable to open Optical Nonworkflow RHS : Date Issue 


Kranit did not check the sceanario
investigation_details/clinical_workflow_send
optical_details/clinical_workflow_send
pharmacy_details/clinical_workflow_send


Questions :
Need to ask Do We need to show Actions and send and timeline in nonworkflow and workflow   


Action Buttons 
investigation_details/_clinical_workflow_actions.html.erb
appointment/appointment_details/_appointment_actions.html.erb
optical_details/_clinical_workflow_actions.html.erb
pharmacy_details/_clinical_workflow_actions.html

Arrived and Engaged Button in Summary Appointentment Actions 


By Default At the time of Admission creation Admission time and Discharge time are same.But When User Discharge the patient It's takes the discharge time as the summary timeline time too.That's why it's showing accoring the discharge time in summary time line . But If you update the discharge time before the discharging the patient.then It will show updated time in the summmary timeline too. 

Optical Pharmacy and Investigation Page Refresh Issue 


Release Change 
modified:   app/controllers/api/v1/appointments_controller.rb
modified:   app/controllers/investigation/investigation_managements_controller.rb
modified:   app/controllers/prescriptions_controller.rb
modified:   app/views/investigation/investigation_managements/investigation_details/_clinical_workflow_timeline.html.erb
modified:   app/views/investigation/investigation_managements/investigation_details/_investigation_details_section.html.erb
modified:   app/views/prescriptions/optical/optical_details/_clinical_workflow_timeline.html.erb
modified:   app/views/prescriptions/optical/optical_details/_optical_details_section.html.erb
modified:   app/views/prescriptions/pharmacy/pharmacy_details/_clinical_workflow_timeline.html.erb
modified:   app/views/prescriptions/pharmacy/pharmacy_details/_pharmacy_details_section.html.erb


/home/max/hg_ehr_product/app/views/patient_summary_timelines/event_links/full_view/_appointment.html.erb












get 'opd_clinical_workflow/mark_as_arrived'
get 'opd_clinical_workflow/patient_engaged'
get 'opd_clinical_workflow/patient_completed'




app/controllers/opd_records/ophthalmology_notes_controller.rb                                     |  6 ++++--
 app/controllers/patients_controller.rb                                                            |  1 -
 app/services/patients/update_service.rb                                                           |  2 +-
 app/views/opd_records/_patient_general_history.html.erb                                           | 16 ++++++++--------
 app/views/opd_records/ophthalmology_notes/_complain_fields.html.erb                               |  6 +++---
 app/views/opd_records/ophthalmology_notes/_eyesubjective.html.erb                                 |  2 +-
 app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_history.html.erb |  4 ++--
 lib/tasks/migration/old_casesheets_medics.rake                                                    |  2 +-
 lib/tasks/migration/patient_diagnoses_procedure.rake                                              |  4 ++--
 lib/tasks/migration/update_old_casesheets_medics.rake   

Tasks 
1.Write down the Sceanrio for Non-workflow State Change Transition
A.Create the appointment in Nonworkflow   Done 
B.Mark Patient Arrived                    Done  
C.Create Eye Template and Fill the Glassess Prescription and Investigations and Medicine . Done 
D.Click all the button and play with the timeline timing  Done 
E.Now go the Optical and Pharmcy Sectiond Non Worktime line should be there  Done 
F.Also Create all the data for workflow patient and check Work patient patient should be there. Done 
E.Add Non-workflow appiontemnt from Summary and Arrived and complete the patient form there and Check OPD.   Done
F.On Tablet Side you need to Create Appointent and Click all the button and check the states with web patient in non workflow facility. Done 
G.You need to create with Token settings too. by clicking twice or single click.one More appointment.   Done 


2.Write down the Sceanario for All Templates Ajit 
A.Create Patinet in Workflow and Nonworkflow 
B.And Create Eye Template , Postop and Lens and Refraction template
C.And Fill the data in refraction tab and Add atleast one investigation in all possible types
D.And add porcedure in all possible types
E.And All diagnosis all possible types
F.And Add Medication From Set and By Searching 
G.And Create Followup appointment 
H.Add Advice set 

FOR ORTHO Freeform :
1.Create a patient in Ortho 
2.And Create Freeform tempmlate for this and add all investiation possible 
3.And Create Diagnosis for possiblet Sceanrio





1.IRIS Comments in Eye templates 
2.Diagnosis Frequesnt Diagnosi 


1.Upload Actions Working fine
2.Ot Actions 
3.


Admit Patient form 



appointmentid=5ba77c8d2c1b502d9b25f844&patientid=5ba77c8b2c1b502d9b25f83c&session=true&templatetype=eye"

:viewmode : @mode

icd_code_search
temp_summary_nonworkflow





Steps for Appointments Testing 
A.Create the appointment in Nonworkflow    
B.Mark Patient Arrived 
C.Click all action buttons and check the timeline timing.                       
D.Create Eye Template and Fill the Glassess Prescription and Investigations and Medicine .  
E.Now go the Optical and Pharmcy Section and check nonworkflow time line should be there.
F.Login for lab and radiology and check timeline for that patient   
E.Add Non-workflow appiontemnt from Summary and Arrived and complete the patient form there and Check that appointment's time line in OPD Section 
G.You need to create appointment by enbaling the Token settings too. by clicking twice or single click.one More appointment.    
F.On Tablet Side you need to Create Appointent and Click all the button and check the states with web patient in non workflow facility. 


Steps for Responsive template testing
A.Create Patient in Workflow and Nonworkflow 
B.And Create Eye Template , Postop and Lens and Refraction template
C.And Fill the data in refraction tab and Add atleast one investigation in all possible types
D.And add porcedure in all possible types
E.And All diagnosis all possible types
F.And Add Medication From Set and By Searching 
G.And Create Followup appointment 
H.Add Advice set 


OT Sections
OPD Templates 
Uploads
IPD
Admission
Appointment
OpdTemplat


Diagnosis and Procedure Search With Code 
1.Default Diagnosis Should search with code 
2.Custom Diagnosis Should search with code 
3.Common Procedure Search with code 
4.Custom Procedure Search with code 

 
ipd template from summary  946fcc614ecc55e5b428befdb2383dc55fa39393
Opd Template from Summary  b097d7a45f72f7549dcafd12eff37727e8b6d7a6



opd_templates_summary for Sumamry with opd Templates 
temp_summary_nonworkflow  Summary With IPD NON Responsive templates 
icd_code_search for Procedure and Diagnosis search with code 
small_changes_ajit :  Lens and Tin Number Changes
nonworkflow_analytics : Analytics and NonWorkflow  
nonworkflow_states_ajit : 

hg_ehr_product/app/views/opd_appointments/list/_counsellor.html.erb

Lens Name Replace 
modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_l_eye_lens_examination.html.erb
modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_l_eye_optometrist_examination.html.erb
modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_r_eye_lens_examination.html.erb
modified:   app/views/opd_records/ophthalmology_notes/opd_partials/_r_eye_optometrist_examination.html.erb
modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_examination.html.erb
modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_examination_trauma.html.erb
modified:   app/views/opd_records/ophthalmology_notes/opd_partials/summary/_opd_summary_form_lens_examination.html.erb



Tin No 

#inventory/sidebar/free_invoice/freeInvoiceOptical.jst.eco                                      Done   
#app/assets/templates/inventory/sidebar/free_invoice/freeInvoicePharmacy.jst.eco                Done 
app/views/invoice/inventories/department/optical_invoices/_checkout_bill_tax_disabled.html.erb  Done 
app/views/invoice/inventories/department/optical_invoices/_checkout_bill_tax_enabled.html.erb   Done 
pp/views/invoice/inPnqventories/department/optical_invoices/_edit.html.erb            Done 
app/views/invoice/inventories/department/optical_invoices/_show_tax_disabled.html.erb Done 
app/views/invoice/inventories/department/optical_invoices/_show_tax_enabled.html.erb  Done 
app/views/invoice/inventories/department/pharmacy_invoices/_edit.html.erb          Done 


Work needs 
app/views/invoice/inventories/department/pharmacy_invoices/_new.html.erb           Work  
app/views/invoice/inventories/department/pharmacy_invoices/_prescription.html.erb  Work 

app/views/invoice/inventories/department/optical_invoices/_new.html.erb            work
app/views/invoice/inventories/department/optical_invoices/_prescription.html.erb   Work 

Invoice Print
invoice/inventories/department/pharmacy_invoices/print_invoice_tax_disabled.html.erb
app/views/invoice/inventories/department/pharmacy_invoices/print_invoice_tax_enabled.html.erb

inventories/department/optical_invoices/print_invoice_tax_disabled.html.erb
invoice/inventories/department/optical_invoices/print_invoice_tax_enabled.html.erb








Lens OPD Record ID : 5bac61f92c1b5013a4630f8c
Non Lend OPD Record ID : 5bac63a02c1b5013a4631088


Quick Eye Files Changes 
opd_records/ophthalmology_notes/opd_partials/summary/opd_summary_form_examination
OPD_summary_form.html.erb


opd_records/ophthalmology_notes/opd_partials/summary/opd_summary_form_quickexamination


nonworkflow and analytics conflicts 
1.app/controllers/appointments_controller.rb
2.app/controllers/api/v1/appointments_controller.rb


Test Sceanrios : 
summary and cicd conflict : 
app/views/opd_records/ophthalmology_notes/opd_partials/_opd_template_form.html.erb
app/controllers/appointments_controller.rb
app/controllers/api/v1/appointments_controller.

work october 
1.Dr. Shiv Changes 
2.Center Head Login
3.Gamification
4.Incomplete State for all patients who are in Waiting state 
5.Remove Old Rakes more than 3 Months 

Reminder Note file changes :
modified:   app/controllers/api/v1/appointments_controller.rb
modified:   app/controllers/api/v1/inpatients_controller.rb
modified:   app/controllers/inpatients_controller.rb
modified:   app/controllers/opd_appointments_controller.rb
modified:   app/controllers/outpatients_controller.rb
modified:   app/controllers/patients_controller.rb
modified:   app/views/inpatient/home/admission_management/_admission_details.html.erb
modified:   app/views/inpatients/_common_css.html.erb
modified:   app/views/inpatients/admission/admission_details/_admission_actions.html.erb
modified:   app/views/inpatients/admission/admission_details/_admission_details_section.js.erb
modified:   app/views/inpatients/ot/ot_details/_ot_actions.html.erb
modified:   app/views/inpatients/ot/ot_details/_ot_details.html.erb
modified:   app/views/inpatients/ot/ot_details/_ot_details_section.js.erb
modified:   app/views/investigation/investigation_managements/_common_css.html.erb
modified:   app/views/opd_appointments/calendar/_calendar_appointment_details.html.erb
modified:   app/views/opd_appointments/list/_doctor.html.erb
modified:   app/views/opd_appointments/list/_show_appointment_details_without_workflow.html.erb
modified:   app/views/opd_appointments/list/_showday_appointment_details.html.erb
modified:   app/views/outpatients/_common_css.html.erb
modified:   app/views/outpatients/appointment/appointment_details/_appointment_actions.html.erb
modified:   app/views/outpatients/appointment/appointment_details/_appointment_details_section.js.erb
modified:   app/views/patient_summary_timelines/_common_css.html.erb
modified:   app/views/patients/_contactcard.html.erb
modified:   app/views/patients/_patientsearchresult.html.erb
modified:   app/views/patients/_showpatientsummarycontentpanel.html.erb
modified:   app/views/prescriptions/_common_css.html.erb
modified:   app/views/prescriptions/_optical_patient_details.html.erb
modified:   app/views/prescriptions/_pharmacy_patient_details.html.erb
modified:   app/views/search/results/diagnoses/_common_css.html.erb
modified:   app/views/search/results/procedures/_common_css.html.erb
modified:   app/views/settings/_common_css.html.erb
modified:   config/routes.rb
modified:   spec/features/list_view_specs/clinical_workflow/doctor_list_view_spec.rb
modified:   spec/features/list_view_specs/non_workflow/list_view_spec.rb



Release Notes :
Smal Fixes :
1.Reminder Note
2.Add medicine number in IPD and OPD Stock count
3.Add IPD Medicine in summary Prescription
4.Shiv Changes   





1.Need BE Vision in Refraction' Visual Acuity
2.Need Cross in Refraction PR 
3.In Cover Test : D and N Test 
4.Binocular Vision Test : NPA and AA test  and NPC

Asking for Adding D Bifocal and KT Bifocal in Type of Lens 


Release Preparation :




Near point of accommodation
Near point of convergence
Amplitude of accommodation


Hi Vijay, there are some change request from a Doctor
1.Need BE Vision in Refraction' Visual Acuity
2.In Cover Test : D and N Test
3.Binocular Vision Test : NPA and AA test  and NPC
4.Need Cross in Refraction'r Visual Acuity PR 

need clarification on these requirements


Incomplete State Work 
1.add extra field closing time in facility
2.Write migration for old facility
3.Write incomplete state logic for Every days appointments
4.Write all appointment migration for putting them in incomplete state 
5.Remove My Queue and Add Incomplete Queue for Previous days appointment
6.Add Incomplete Queue for nonworkflow
7.If patient in not in scheduled or Incomplete state 
8.Disble the button for nonworkflow 

sms job and Scheduled Queue 


FacilitySetting.all.each_with_index do |fac,i|
  puts fac.id
  puts fac.discharge_sms_time
  puts fac.appointment_sms_time 
end 



Reminder 
1.no_timeout
2.write all migration in one file 
3.Data should not affect while migration run twice 
4.How to get all the indexes from the mongo shell and conver into js 
5.Dog Time log how to implement 


Tasks:
1.Testing My Code in PP 2 hours 
2.Testing on Tablet Side 
3.Testing Cashsheet branch  in Tablet 
4.Solve Merge On conflict on this branch Small issues ajit branhc on IPD Record 
5.Put Scenario on one document and ask them to test 
6.



ophthalmology_notes/opd_partials/summary/_opd_summary_form_examination.html.erb
ophthalmology_notes/opd_partials/summary/_opd_summary_form_examination_trauma.html.erb
opd_partials/summary/_opd_summary_form_quickexamination.html.erb



Sceanrios 
1.For Copy click Add data also fill in glasses prescription
2.And fill data form Glasses prescription also calculate near data 


Incomplete State for Patient :
AppointmentListView.last
current_state
scheduling_date
scheduling_time
updated_at
created_at
appointment_date
appointment_start_time

state : Scheduled
state : Engaged
state : Completed

updated_at
appointment_start_time

AppointmentListView :
AppointmentListView.last
appointment_date
appointment_start_time
updated_at/appointment_engaged_time
current_state


state                | Scheduled              Arrived                 Completed 
created_at           | 04 Oct 2018 08:10:00  04 Oct 2018 08:10:00    
update_at            | 04 Oct 2018 08:10:00  04 Oct 2018 08:15:52    04 Oct 2018 08:21:52       
appointment_date     | 04 Oct 2018             
appointment_start_time|04 Oct 2018 08:10:00  04 Oct 2018 08:15:52

"2018-10-04 02:40:00 UTC".in_time_zone("Asia/Kolkata")


Appointment Model
1.Patient Arrived :arrived: true, start_time: Time.current
2.

modified:   app/controllers/outpatients_controller.rb
modified:   app/models/facility_setting.rb
modified:   app/models/opd_clinical_workflow.rb
modified:   app/services/appointment/non_workflow_opd.rb
modified:   app/views/outpatients/appointment/_data_rows.html.erb
modified:   lib/tasks/migration/incomplete_appointments.rake















db.facilities.update(
  {},
  { $unset: {'closing_time':1}},
  false, true
)

db.facility_settings.update(
  {},
  { $unset: {'facility_closing_time':1}},
  false, true
)




Appointment.find_by(id:"5bb579012c1b50295ebb1208")
AppointmentListView.find_by(appoitnment_id:"5bb579012c1b50295ebb1208")
OpdClinicalWorkflow.find_by(appointment_id:"5bb579012c1b50295ebb1208")








Below is update as follows, please review:-

A. Per feedback from Mr Shiva, we have incorporated changes into our product. We are attaching screenshots of the same. Changes 1, 2, 4, & 5 are done from below list (screenshot is attached with each change). 

B. For remaining changes from below list, we have consulted our in-house Ophtalmologist and provided alternatives or updates for each change. Please review the same in the below list. 

1.Need BE Vision in Refraction' Visual Acuity
Ans. We have given comment boxes for that. As its not something used by everyone for every patient. It's rarely mentioned. That's why a comment box.

2.Replace Lens to Contact Lens in Refraction Visual Acuity
Ans. Done 

3.Need Cross in Refraction'r Visual Acuity PR 
Ans. We had thought of making a cross for PR showing 4 quadrants. But we gave 4 drop downs for the four findings.

4.Add in Glasses Prescriptions 
Ans. We have added this in Refraction Glasses Prescriptions. 

5.Add D Bifocal and KT BIfocal in Type of Lens 
Ans. We have Added this in types of lens.

6.In Cover Test : D and N Test
Ans.In OrthOptics template Again, comment boxes r provided 

7.Binocular Vision Test : NPA and AA test  and NPC
Ans.It's not a test per say,It's just a finding in examination
That's why most don't do it or mention it.So it can be written in a text box.

8.Cover Test and Binocular Vision test in Eye Template Refraction.
Ans. We have text boxes given in refraction sections (both dry and wet).. And comment boxes in glasses prescriptions as well


-- More changes can only be done after signup. Also, we need to work on migrating existing data. Please let us know the next steps. 

Thanks, Ajit
Health Graph.



5bb6d2b92c1b5013301ab9a9 NonWorkflow 



Action buttons for workflow and Non workflow 
State Flow for workflow and Non workflow 


app/controllers/outpatients_controller.rb
app/models/appointment.rb
app/views/outpatients/appointment/_data_rows.html.erb
app/views/outpatients/appointment/appointment_details/_appointment_actions.html.erb
app/views/outpatients/appointment/appointment_details/_appointment_timeline.html.erb
lib/tasks/migration/incomplete_appointments.rake





Pacific/Pago_Pago    -11
Antarctica/Macquarie : +11



Time.parse("11:59 PM").in_time_zone("Asia/Kolkata").utc
Time.parse("11:59 PM").in_time_zone("Pacific/Pago_Pago").utc
Time.parse("11:59 PM").in_time_zone("Antarctica/Macquarie").utc


Time.parse("11:59 PM").in_time_zone("Asia/Kolkata") 
Time.parse("11:59 PM").in_time_zone("Asia/Kolkata").utc
"2018-10-04 18:29:00 UTC".in_time_zone("Asia/Kolkata").strftime("%I:%M %p")

Tasks:
1.Write a logic for old day Incomplete Queue replace My Queue Showing   Done 
2.Write logic for Facility Avg Waiting time       Logic for AVG Waiting time     Done                      
3.Write logic for Month-Wise Data migration for incomplete patient see old rake : 1 hours  Done   
4.Change Username icon to User icon only          1 hours 
5.Diagnosis Wala logic                     1 hours
6.Old Migrations Date wise logic  1 hours 


58b6b4686c55d3b8a5400a23
58b6b4626c55d3b8a5400a22

 User Average Time Data :

Analytics::UserAverageTime.all.each do |user|
[42] pry(main)*   puts User.find_by(id:user.user_id).username  
[42] pry(main)*   user.total_average_time_in_hrs  
[42] pry(main)*   puts "patient seen #{user.total_patient_seen}"  
[42] pry(main)* end 






2018-10-08 11:02:59 UTC


Worked on Branch 
small_issues_ajit    Dr Shiva Changes 
incomplete_patient_state for incomplete appointments 



/home/max/hg_ehr_product/app/views/navbar/roles/_admin.html.erb


1d2939


OpdClinicalWorkflow.find_by(appointment_id:"5bbc35b32c1b50139d747e36").opd_clinical_workflow_state_transitions.count

OpdClinicalWorkflow.find_by(appointment_id:"5bbc35b32c1b50139d747e36").opd_clinical_workflow_state_transitions.each do |opd|
puts opd
end


User.where(facility_ids:"58b6b4626c55d3b8a5400a22","$or":[{role_ids:158965000},{role_ids:6868009}])

"$or": [{name: /#{Regexp.escape(params[:search])}/i
+    }, {code: /#{Regexp.escape(params[:search])}/i}])


User.where(facility_ids:"58b6b4626c55d3b8a5400a22",:role_ids.in :[6868009,158965000])





Why I need facility loop 
1.Need Patients only same time period according to facility timezone 
2.





OpdClinicalWorkflow.where(appointmentdate: date, facility_id:facility.id, :state.nin : ["cancelled","not_arrived","complete","incomplete"])




2018-09-01
2018-09-15



Workflow : 01 to 5 sept

Nonworkflow  01-to 5 
Kranti 15 to 20 sept


opd_new_patient_count
opd_old_patient_count



# bundle exec rake update_appointment_state:average_time RAILS_ENV=development
# bundle exec rake update_appointment_state:total_user_time RAILS_ENV=development



padding: 7px;
    border-radius: 100%;
    border: 1px solid #a8dfdf;
    text-align: center;

cmh = '5927e6b1666d672015134d7e'
tvm = '58a28f02666d6745d13a648f'
ctk = '59439724666d676a73ff0597'
bmh = '5829e7a1666d673ff100144b'


one =  '58b6b4626c55d3b8a5400a22'
two =  '58b6b4686c55d3b8a5400a23'
three = '58b6b46c6c55d3b8a5400a24'
four =  '58b6b4716c55d3b8a5400a25'


fac_array = array[one,two,three,four] 


Work in small_issues_ajit branch
1.Dr.Shiva change / Added Lens Types 
2.Add in Glasses prescription
3.Comment box in Refraction
4.comment box for Each Radio 
5.Vision Length 6 to 12
6.Refraction text box width 100%
7.IPD Medicine Number 
8.Medicine added from IPD should be in Summary
9.Remove Rmeinder Note 

Manu Work Final assesment 
1.Done Assessment 

Incomplete Patient State 
1.Incomplete State work 
2.Migration fixes in this branhc and make compaitable with Rails5 Cicd  


Patient Postman Submit Data for PSR history 
{"current_user_id":"58b6d25a5e751b4f33110aa5","current_facility_id":"58b6b4626c55d3b8a5400a22","patient_id":"5bceb36e2c1b500de7296dc2","patient_history":{"chief_complaints_attributes":{"0":{"_destroy":"","name":"shadow_defect_in_vision","side":"R","duration":"4","duration_unit":"weeks","comment":"fee","history_started":""},"1":{"_destroy":"","name":"discoloration_of_eye","side":"B/E","duration":"3","duration_unit":"weeks","comment":"eee","history_started":""}},"complaints":"blurring_diminution_of_vision,headache_strain,glaucoma_opinion,","other_history":{"family_history":"","glaucoma_history":"No","medical_history":"","myopia_history":"No","RetinalDetachment_history":"Yes"},"personal_histories":"alcoholism","personal_history_records_attributes":{"0":{"_destroy":"","name":"alcoholism","hidden_duration":"15.weeks","duration":"15","duration_unit":"weeks","comment":"3333","history_started":""}},"history_comment":"","drug_allergies":"antiviral_agents","antimicrobial_agents":"","antifungal_agents":"","antiviral_agents":"nelfinavir","allergy_histories_attributes":{"0":{"_destroy":"","name":"nelfinavir","hidden_duration":"","duration":"","duration_unit":"weeks","comment":"","allergy_type":"drug_allergies","allergy_subtype":"antiviral_agents"},"1":{"_destroy":"","name":"tegaderm","hidden_duration":"","duration":"","duration_unit":"weeks","comment":"","allergy_type":"contact_allergies","allergy_subtype":""},"2":{"_destroy":"","name":"shellfish_only","hidden_duration":"","duration":"","duration_unit":"weeks","comment":"","allergy_type":"food_allergies","allergy_subtype":""}},"speciality_histories":"glasses","speciality_history_records_attributes":{"0":{"_destroy":"","name":"glasses","l_hidden_duration":"5.weeks","r_hidden_duration":"5.weeks","l_duration":"5","l_duration_unit":"weeks","r_duration":"5","r_duration_unit":"weeks","comment":"3333"}}}}

on storing self history 

1.Complaints String not coming properly 
2.Complaint : replace option with comment , history_started 
3.Personal History Record : comment not coming, history_started
4.Add comment in Special Record histroy and   




psr_new_history
1.Check how he represent the data on View 
2.Now see selfhistory View for and createnew View 
3.Write a logic for Fill self history in template from Verify self history. 

What is the use of that hidden fields




Now When you click any button in Refraction you will see one extra text box corresponding to that in which you can add extra information.
In Print refraction extra information will look like this. 
Now in Vision text box, text limit also increased to 12 characters.
Now you can change time manually in IOP.
We are working on other changes too.
Thanks, Ajit 
Healthgraph 


1.Need to come all the other history
2.And all allergies data also come 

Final updated PSR Request 
{"allergies":{"contact_comment":"contact","contact_allergies_present":"YES","drug_comment":"drugs taking","drug_allergies_present":"YES","eyedrop_comment":"eye drops","eyedrop_allergies_present":"YES","food_comment":"food","food_allergies_present":"YES","other_allergies":"allergy comments"},"chief_complaints_attributes":{"1":{"comment":"shout","complaint_options":"Sudden Onset","duration":"3","duration_unit":"Months","name":"redness","side":"L"},"10":{"comment":"good","complaint_options":"","duration":"9","duration_unit":"Years","name":"glaucoma_opinion","side":"L"},"5":{"comment":"discharge","complaint_options":"Watery","duration":"11","duration_unit":"Months","name":"discharge","side":"L"},"0":{"comment":"bluffing","complaint_options":"Sudden","duration":"4","duration_unit":"Months","name":"blurring_diminution_of_vision","side":"L"},"14":{"comment":"checkout","complaint_options":"","duration":"17","duration_unit":"Months","name":"discoloration_of_eye","side":"BE"},"9":{"comment":"headache","complaint_options":"","duration":"3","duration_unit":"Months","name":"headache_strain","side":"R"},"11":{"comment":"other","complaint_options":"Intolerance to Light","duration":"3","duration_unit":"Years","name":"other_visual_symptoms","side":"R"},"2":{"comment":"pain","complaint_options":"Severe","duration":"4","duration_unit":"Days","name":"pain","side":"L"},"13":{"comment":"Shadow","complaint_options":"","duration":"7","duration_unit":"Months","name":"shadow_defect_in_vision","side":"L"},"8":{"comment":"squint","complaint_options":"Trauma","duration":"Months","name":"deviation_squint","side":"L"},"6":{"comment":"dryness","complaint_options":"","duration":"4","duration_unit":"Months","name":"dryness","side":"BE"},"12":{"comment":"lack","complaint_options":"","duration":"12","duration_unit":"Months","name":"Lasik_opinion","side":"L"},"4":{"comment":"watering","complaint_options":"","duration":"7","duration_unit":"Months","name":"watering","side":"L"},"7":{"comment":"fb sensation","complaint_options":"","duration":"7","duration_unit":"Months","name":"itching","side":"L"},"3":{"comment":"injury","complaint_options":"","duration":"4","duration_unit":"Months","name":"injury","side":"L"}},"complaints":"blurring_diminution_of_vision,headache_strain,glaucoma_opinion,redness,pain,injury,other_visual_symptoms,watering,discharge,dryness,itching,deviation_squint,shadow_defect_in_vision,Lasik_opinion,discoloration_of_eye,","history_comment":"special","opthal_history_comment":"currently","other_history":{"family_history":"other family problems","glaucoma_history":"Yes","current_medications":"currently medications","medical_history":"medical history","myopia_history":"Yes","retinal_detachment_history":"Yes"},"personal_histories":"diabetes,hypertension,alcoholism,cns_disorder_stroke,cardiac_disorder,thyroid_disorder,hyperthyroidism,asthma,hiv_aids,tuberculosis,cancer_tumor,smoking_tobacco,on_insulin,on_aspirin_blood_thinners,drug_abuse,steroid_intake,","personal_history_records_attributes":{"1":{"duration":"3","duration_unit":"Months","name":"hypertension"},"10":{"duration":"3","duration_unit":"Months","name":"hyperthyroidism"},"5":{"duration":"11","duration_unit":"Months","name":"cancer_tumor"},"0":{"duration":"3","duration_unit":"Months","name":"diabetes"},"14":{"duration":"4","duration_unit":"Years","name":"on_aspirin_blood_thinners"},"9":{"duration":"11","duration_unit":"Days","name":"cns_disorder_stroke"},"11":{"duration":"14","duration_unit":"Months","name":"steroid_intake"},"2":{"duration":"6","duration_unit":"Months","name":"alcoholism"},"13":{"duration":"3","duration_unit":"Years","name":"on_insulin"},"8":{"duration":"3","duration_unit":"Months","name":"asthma"},"6":{"duration":"4","duration_unit":"Months","name":"cardiac_disorder"},"12":{"duration":"8","duration_unit":"Months","name":"drug_abuse"},"4":{"duration":"3","duration_unit":"Months","name":"hiv_aids"},"7":{"duration":"6","duration_unit":"Months","name":"tuberculosis"},"3":{"duration":"4","duration_unit":"Years","name":"smoking_tobacco"}},"speciality_histories":"glaucoma,glasses,eye_disease,eye_surgery,retinal_laser,retinal_detachment,uveitis,","speciality_history_records_attributes":{"5":{"l_duration":"13","l_duration_unit":"Months","name":"uveitis","r_duration":"12","r_duration_unit":"Months"},"4":{"l_duration":"3","l_duration_unit":"Months","name":"eye_surgery","r_duration":"3","r_duration_unit":"Years"},"0":{"l_duration":"3","l_duration_unit":"Months","name":"glaucoma","r_duration":"3","r_duration_unit":"Months"},"1":{"l_duration":"4","l_duration_unit":"Months","name":"retinal_detachment","r_duration":"4","r_duration_unit":"Months"},"3":{"l_duration":"12","l_duration_unit":"Months","name":"eye_disease","r_duration":"13","r_duration_unit":"Months"},"6":{"l_duration":"4","l_duration_unit":"Months","name":"retinal_laser","r_duration":"4","r_duration_unit":"Months"},"2":{"l_duration":"5","l_duration_unit":"Months","name":"glasses","r_duration":"5","r_duration_unit":"Months"}}}


client_id = 'b06ed9dfe98d5617702600d3e6cdd8d48e164d9d6887082ae47f617303d6af0a'
client_secret = '9dea736cafd4b090d5c731ecb99e67b89cefce45c5609de9cf3f2f386dc47811'


Inventory Discussion With Anoop
1.STI : single table inheritance 
2.See the video
3.Go through all the models and  

Migration for Complaint duration unit which is later on 18th sept 




Rake for Duration unit in complaint rake 
# bundle exec rake update_complaint_duration_unit:opdrecord RAILS_ENV=development

namespace :update_complaint_duration_unit do
  desc "updating complaint duration unit"
  task :opdrecord : :environment do
    @start_date = "2018-07-01"
    @end_date = "2018-10-31"
    @count = 0
    @year_count = 0
    @zero_count = 0
    @else_count = 0
    opdrecords = OpdRecord.where(created_at: (@start_date)..(@end_date),specalityid: "309988001",chief_complaints.nin : [nil])
    puts "Total OPD Recordd #{opdrecords.count}"
    puts "not nil count #{op_nil}"
    opdrecords.each_with_index do |opdrecord, i|
      #puts i
      if opdrecord.chief_complaints.count > 0
        @count = @count + 1 
        opdrecord.chief_complaints.each_with_index do |cc,j|
          #puts j
          if cc.duration_unit == "year"
            #puts opdrecord.id
            #cc.update(duration_unit:"years")
            @year_count = @year_count + 1
          end
        end
      elsif opdrecord.chief_complaints.count == 0
        @zero_count = @zero_count + 1 
      else
        @else_count = @else_count + 1       
      end      
    end
    puts "Total count #{@count}"
    puts "Year  #{@year_count}"
    puts "Zero  #{@zero_count}"
    puts "else  #{@else_count}"
  end
end

1.Test Document nil
https://docs.google.com/document/d/1MFDN_szMXx3cb_TvQ9yH1xfhMecZeaVXl8yPBn0G2xo/edit


Inventory Work:
1.Inventory::Vendor
2.Inventory::Item
3.Inventory::Department
4.Inventory::CheckoutLog


1.Checkout: 
Inventory::CheckoutLog::Item

1.Deprtament:
1.Inventory::Department::Item
2.Inventory::Department::RequestLog


  Item 
  1.Inventory::Department::Item::Consumable
  2.Inventory::Department::Item::Implant
  3.Inventory::Department::Item::Lot
  4.Inventory::Department::Item::Medication
  5.Inventory::Department::Item::Miscellaneous
  6.Inventory::Department::Item::Stock
  7.Inventory::Department::Item::Stockable


1.Item: 
1.Inventory::Item::Stockable
2.Inventory::Item::Miscellaneous
3.Inventory::Item::Lot
4.Inventory::Item::Medication
5.Inventory::Item::Implant
6.Inventory::Item::Consumable
7.Inventory::Item::Asset


1.Inventory::Item:: 
1.Inventory::Item::Optical::Contact
2.Inventory::Item::Optical::Frame
3.Inventory::Item::Optical::Other


Inventory::Department::RequestLog::Item

Item flow :



Central Store :
Add to Inventory:
Inventory::ItemsController#new 

Checkout History:
Inventory::CheckoutLogsController#index

Show Cart 
Inventory::ItemsController#show_cart

Refresh Inventory Items 
InventoryController#refresh_inventory_list


Optical
1.Checkout History
Invoice::Inventories::Department::OpticalInvoicesController#index 
2.Request Items
Inventory::Department::RequestLogsController#new
3.Advance History
Invoice::Inventories::Department::OpticalInvoicesController#advance_patient_list
4.Details
Inventory::Department::ItemsController#show
5.Free Receipt
Inventory::Department::ItemsController#update_cart
6.InventoryController#refresh_inventory_list 
7.

Pharmacy
1.Checkout History
Invoice::Inventories::Department::PharmacyInvoicesController#index 
2.Request Items
Inventory::Department::RequestLogsController#new
3.Advance History
Invoice::Inventories::Department::OpticalInvoicesController#advance_patient_list
4.Details
Inventory::Department::ItemsController#show 
5.Free Receipt
Inventory::Department::ItemsController#update_cart
6.Refresh
InventoryController#refresh_inventory_list 



Git Tagging
1.git checkout ajit
2.git tag v1.0
3.git tag 
4.git tag -a "TAG NAME" -m "This is tag for version v1.1."
5.git tag
6.git show v1.1
7.git push origin v1.1
8.git push --tags
9.git push -d v1.1
10.git push --delete v1.1
11.git checkout -b ajit v2.2
12.git tag v2.1 commit id


Git Tagging https://www.youtube.com/watch?v=govmXpDGLpo




lib/tasks/migration/old_incomplete_appointments.rake


IPD Notes Refactor
1.Show Checklist on Discharge 
2.Arrange notes in Pre During and Post
3.Need to make workflow 
4.



https://docs.google.com/spreadsheets/d/108lIlsjHegP-2l1qa586Is9TMWwNbLMr7xW6VNxQdys/edit#gid=0

appointmentdate: ((@start_date)..(@end_date)),

https://docs.google.com/document/d/1UekK1kSnA9hCUGxD1V07alYlZaKCOcpZ3aCBi8x7TDg/edit


Issues :some OPDWorkflow is there that have state is completed but in that some states is where transistion_end is nil

OpdClinicalWorkflowStateTransition.where()


16Oct to 31 Oct 
01 Nov to 15 Nov 

packet_write_wait: Connection to 13.229.237.19 port 722: Broken pipe


A.Incomplete State Workflow 
1.Scheduler Job should work                                   Test 
2.Prev date My Queue Should come as Incomplete in Workflow    Done   
3.For Non Workflow One Extra Header with incomplete and show inocomplete appointments there 
4.Time difference for Incomplete for Workflow            Done  
5.Time Difference for Incomplete Patient For Nonworkflow Done  
6.Action Button Should not show on back and forth date in workflow Done 
7.Action Button Should not show on back and forth date in Non-workflow Done 

B.Invoice 
1.
2.
3.
4.



C.Admissionn and Appointment count in Orthopedics 
1.When I mark arrived patient it doesnot increase count for arrived patient but when I mark_not_arrived it decrease the arrived count.

2.When I admit patient form OPD and Admit patient in IPD it gives error
An ActionView::Template::Error occurred in ipd_casesheets#edit:
  undefined method `id' for nil:NilClass
  app/views/inpatient/ipd_record/admission_note/orthopedics_notes/_additional_details.html.erb:67:in `_app_views_inpatient_ipd_record_admission_note_orthopedics_notes__additional_details_html_erb___986756286717415786_241496280'

3.When I open RHS for Admission : 
A NoMethodError occurred in admissions#create:
  undefined method `diagnoses' for nil:NilClass
  app/services/case_sheet/create_admission_service.rb:175:in `set_analytics_params'  

4.When I add admission from IPD then I add new case 
A NoMethodError occurred in admissions#create:
  undefined method `diagnoses' for nil:NilClass
  app/services/case_sheet/create_admission_service.rb:175:in `set_analytics_params'

IPD Refactor 
1.Assessment Changes 
2.Make Seperate OT Checklist  
3.

ALDRETE Score for Discharge 
Pain Assessment 
Sedation and Analgesia chart
Care Plan 
Monitored Anesthesia Form

Anesthesia Questionare
Discharge Checklist
Operative Note 
Assessment form 
Operative Checklist 




Testing Scenario
1.Analytics- Finance
A.Patient Arrived count not increasing
B.Old patient counting as new patient and 
C.Old patient bill collection counting as new for those migration not run
D.IPD Total Invoice Count not coming
E.Optical Invoice cpunt also not coming

2.changes in navbar
3.Free form in ortho an ophthal
4.Analytics-quick overview
5.Incomple state in work flow
6.Invoice
7.Ipd Admission creation with all templates
8.Analytics-operational
9.Appointment creation with eye and optometrist template
10.TPA
11.Invoice 
12.orthopedics- Appointment and admission creation 







https://demo.hgraph.in/analytics/admins



ActionView::Template::Error (can't add a new key into hash during iteration):




1.Pain Assessment Form
A.Need to add Smile faces 
B.Edit and Print Form View and Summary View

2.Sedation form

3.Nursing care plan
A.Edit and Print Form View and Summary View
B.Nurse Name and Other Date and Time in form 

4.Aldrete Score
A.Aldrete Score print View 
B.Edit Button and 


5.Monitored Anesthesia care form


Need to Decide the alignment of the items according to pre post and during 

1.Need Print and Summary View for all form :  11 AM  
2.Complete small text in all form         :  Lunch 
3.Add Opd Record Params to Nursing Record Too : 4.00 PM
4.Alignment according to Pre During and post :  7 PM 
5.Code Review                           : 10 PM
6.Testing Functionality Review          : Lunch 
7.Migrationa and Add some field in Ot Checklist : 6 PM 
8.Check for Ortho and Ophthal Data test        : 10 PM


https://stackoverflow.com/questions/825748/how-to-pass-command-line-arguments-to-a-rake-task

https://www.cyberciti.biz/faq/how-do-i-add-jobs-to-cron-under-linux-or-unix-oses/


Nursing Records 
1.Pain Assessment , Aldrete Score ,Sedation Score ,Nursing Care Plan
2.Facility ID , Template type ,Organisation id , admission_id,   






echo > log/whenever.log 
tail -1000f log/whenever.log
sudo service cron restart

Discussion Regarding Facility code Refactor : Done 
1.Some facility are creating problem out of 308 / 9 are having same code 
2.Because same code is generating for mulitple facility in same organisation 
3.So either we have leave this thing up to user 

Incomplete Appointment Rake  Done 
1.Now All appointment having visit no or not because I need to find appointment each time
2.So Rake time should be more than the first rake complettion time 
3.Do I need to remove puts form Cron job rake 

0 Centre For Vision and Eye Surgery - Navalur Chennai code134 CEFVA Done 
1 Nayandeep Eye Research Centre code157 NAERC
2 Agashe Nursing Home code242 AGNUH
3 Surana Sethia Hospital code253 SUSEH
4 Parakh Hospital code255 PAHOS
5 Mumbra Lion's Camp code280 MULIC
6 Civil Hospital Akola code286 CIHOA
7 Jupiter - JCI  code295 JUJ
8 Civil Hospital Amravati code306 CIHOA


Discussion:
1.All IPD notes should define in to yml file
2.Check whether Surgery coming form admission or casesheet
3.If not update by taking the pull
4.Do Seperate section of Admission, Operative and Discharge and Arrange notes accordingly
5.Show Radio button or checkbox in OT Checklist 
6.Patient Vital Test 




Doubts:
Surgery List in Ortho case 



Phaco with foldable IOL implant - B/E  Advised

Edit Case : 
Inpatient::IpdRecord.find_by(admission_id: params[:admission_id])



opdtemplates: [,, ]







templateid: "75823008",templatetype:"discharge"
Task for today:
1.Write migration for template id and Type update in IPD Notes
2.Write migration for OT Checklist update 
3.Update View according to new Structure 

1.Migration for incomplete patient state 3o minutes  A
2.FacilitySetting.update_all(closing_time:"11:59 PM")  A
3.Migration for calculating Facility and User Average time     22 Nov to 27    
4.Update Facility code migration 2 Minutes  A
5.Need to update cron job        A  

Ipd Notes Refactor Record 
bundle exec rake update_templateid_ipd:ipdrecord RAILS_ENV=development

gitk /home/max/Hgraph/hg_ehr_product/app/views/investigation/investigation_managements/investigation_details/_clinical_workflow_timeline.html.erb

bundle exec rake update_complaint_duration_unit:opdrecord RAILS_ENV=development

https://www.stuartellis.name/articles/rake/

For Surgical Checklist according this form 
1.Will this surgical checklist be same for Opthal and Ortho :
2.Is It good to give checkbox for parent options or we should give internal checkbox for children option too.  

5bffac6b2c1b501ad3bdbb16

<% @nursingrecords = NursingRecord.where(admission_id: @admission.id) %>

1.show all the OTchecklist 

bundle exec rake update_old_appointment_state:average_time[2018-11-01,2018-11-20] RAILS_ENV=development
Tasks 
1.Migrations for Old Checklist: 
2.Do Seperate OT Checklist for Ophthal
3.Do Seperate OT Checklist for Ortho
4.Add Template type and templateid in All IPD template 
5.Field Validation 
6.Patient Vital Date and Time 

If I will take the manu checklist then how do i write the migrations need to check that 
All procedure Will be attached with CaseSheet   

For IPD Work 
1.How write options for Ophthal and Ortho and Make all the field list for Ophthal
2.Then How to write Migration for Old OT Checklist  
3.See the print View for all new forms 
4.Under stand the manu wala code for nested options


Need to make Sure PP Release:             Done     
1.Merge Test Rails5_cicd and analytics merge 
2.Merge Rails5_cicd to small_issues_ajit
3.Merge Rails5_cicd to psr_new_history

Ishank Issue of OPD Patient RHS   Done 
1.Update Code in API for incomplete state 



app/views/outpatients/appointment/appointment_details/_appointment_actions.html.erb


/api/v1/appointments/get_appointment_lists.json?active_user=%20&current_user_id=58b6d2605e751b4f33110aa6&current_date=2018-10-17&current_facility_id=58b6b4686c55d3b8a5400a23"


Anaesthesi amachine checked
Suction checked
Implants checked
Patient Allergy - issues 


Signout :
Valid Consent :
Imaging checked
Antibiotic




Work need to be release:
small_issues_ajit 
1.Reminder note Removed                      Done  
2.Ipd Medicine stock number in Discharge medicine search =  Done
3.Ipd Prescription should be visible in summary = Done 
4.Refraction Comment box in Visual Acuity = Comments 
5.Refracion Visual Acuity one text when select option = Done
6.Lens Type D-focal and KT focal = Done
7.Add in Glassess prescription = Done 
8.Add time picker IOP and remove read only time field = Done 
9.Vision text limit increase to 12 = 


PSR New History Changes  psr_new_history
1.PSR history 
2.Year complaint field 
3.Migration for complaint year 

Sidekiq 
JIRA
REDIS 
Whenever 

Task 
1.OT CHecklist Form Data test  
2.Migration be for OT Checklist

Rake on Production
[2018-10-01,2018-11-21]
[2018-09-01,2018-10-01]

1.Medication-type and stock issues 
2.Make Read only time picker field
3.comment get clear on clear 

tasks 
1.OT Checklist field Validation              Done 
2.Check field name in Model and View side    Done 
3.Check box action in View after save and update Done
4.Write migrations for Old OT Checklist Done 
5.For Old last Operative 

5.Go through with reek Gem for controller insepection 

https://blog.codeship.com/how-to-find-ruby-code-smells-with-reek/

Keep OT Checklist in Operative note 

07-12-2018
1.Create 10 Mongo Query for Peformance with our current data and Group by
2.Write Migration for multiple OT notes   = 
3.Write logic for new OT Checklist according to surgery = Done 
4.Need to find nursing record by id also 

Mongo
Inpatient::IpdRecord.count
OtChecklist.count

If procedure not have ot_checklist_id then we will show that procedure and If ot_checklist_id is same as checklist id then we show that procedure into that checklist.
If Procedure morethan one in checklist and you are not checking that then we need to show warning.

{"ipd_record":{"procedure":{"0":{"id":"5c09fb332c1b500fdd1d6451", "ot_checklist":"true"}, "1":{"id":"5c09fb332c1b500fdd1d6452", "ot_checklist":"true"}}}}
1.Ortho freeform 
2.Ophthal Free form template 

Ortho : opd_records/orthopedics_notes/freeformexaminationplan
Ophthal :opd_records/orthopedics_notes/ophthalmology_notes/freeformexaminationplan


<script type="text/javascript">alert("<%= @specalityfoldername %>")</script>

OpdRecord.where(templatetype: "express").count   2589
OpdRecord.where(templatetype: "trauma").count    116 
OpdRecord.where(templatetype: "express",specalityid: "309989009").count  = 323
OpdRecord.where(templatetype: "trauma",specalityid: "309989009").count  = 97
OpdRecord.where(templatetype: "trauma",specalityid: "309989009").pluck(:organisation_id).uniq  [nil, "57cd4b16666d671e3300007e"] 
OpdRecord.where(templatetype: "express",specalityid: "309989009").pluck(:organisation_id).uniq   [nil, "57cd4b16666d671e3300007e", "576a94ed666d672d44000063"]
exp = OpdRecord.where(templatetype: "express",specalityid: "309989009")
exp.where(organisation_id:"576a94ed666d672d44000063").count    1
 


1.Mongo 10 best commands    
2.Freeform code and express template code and test      Done 
3.Amazon instance with mongo instance and Rails Server simple project
4.Hacker earth competition      Checked  Done 
5.Rails project on github       Done 
6.Write migration for Old Ooperative note  Priority   
7.Phone book and Binsry tree code   Priority 
8.some basic progrmmes with ruby and that code   Then  
9.Add into summary notes   


Migration Test:
1.Create 4 Procedure and 2 Operative note put comment one and two with their performed procedure name 

Date and Time issue with patient Vital 

IPD Work
1.Assessment Changes language removed and text box size  Done  
2.Nursing Record Pain Assessment and Sedation Chart and Aldrete Score and Nursing Careplan
3.OT Checklist Seperate 
4.Operative notes changes
5.Ui Changes for Opthal and Ortho


1.Nursing controller code review       Done  
2.Validation find Sedation chart form   Done   
3.Pain Assessment payment Received date and time =  
4.Print Text Heading bold and form name at the top =  Done 
5.Nursing Records Checklist Field Review = Done  
6.OT checklist date logic create 

Huzi Discussion
1.Below Print Signature issue 
2.Sedation Signature field name 
3.OT Checklist date/time issue 
4.In summary i will show the other note after clinical note 

Now Task Add Assessment Note add update in patient summary View
1.Now Added entry in Ipd Tempaltes 
2.Now write Backgrounf job for update and create event of patient Sumamry timeline 
3.Show patient assessment in all the evts 

Hi All,
We are releasing some small changes listed below -  
1.In OPD templates Extra text box for writing extra information while you click any button in Refraction Visula Acuity
2.In Glasses prescription For calculation purpose add option has been added.
3.Now you can change IOP time manually.

Thanks 
Ajit Healthgraph

1.Write test cases for Nursing Record controller and Ot Checklist Controller 



1st Feb
git clone https://ajit123jain@bitbucket.org/ajit123jain/rails.git
 